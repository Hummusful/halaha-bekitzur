// חיפוש לפי טווח שנים
async function searchAlbumsByYearRange(token, yStart, yEnd, desired) {
  const out = [];
  let next = `https://api.spotify.com/v1/search?q=${encodeURIComponent(`year:${yStart}-${yEnd}`)}&type=album&market=${market}&limit=${PAGE_LIMIT}`;
  for (let i = 0; i < 20 && next; i++) {
    const j = await sp(token, next);
    out.push(...(j.albums?.items || []));
    if (out.length >= desired) break;            // <-- עצירה כשהגענו לכמות המבוקשת
    next = j.albums?.next || null;
  }
  return out;
}

// tag:new
async function searchAlbumsTagNew(token, desired) {
  const out = [];
  let next = `https://api.spotify.com/v1/search?q=${encodeURIComponent(`tag:new`)}&type=album&market=${market}&limit=${PAGE_LIMIT}`;
  for (let i = 0; i < 20 && next; i++) {
    const j = await sp(token, next);
    out.push(...(j.albums?.items || []));
    if (out.length >= desired) break;            // <-- עצירה לפי desired
    next = j.albums?.next || null;
  }
  return out;
}

// browse/new-releases
async function browseNewReleases(token, desired) {
  const out = [];
  let next = `https://api.spotify.com/v1/browse/new-releases?country=${market}&limit=${PAGE_LIMIT}`;
  for (let i = 0; i < 20 && next; i++) {
    const j = await sp(token, next);
    out.push(...(j.albums?.items || []));
    if (out.length >= desired) break;            // <-- עצירה לפי desired
    next = j.albums?.next || null;
  }
  return out;
}
